<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Chapter 10. Backing up Docserv² data</title><link rel="stylesheet" type="text/css" href="static/css/docserv-style.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.2" /><link rel="home" href="index.html" title="Docserv² Guide" /><link rel="up" href="index.html" title="Docserv² Guide" /><link rel="prev" href="config-ssi-fragment.html" title="Chapter 9. SSI fragments" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 10. Backing up Docserv² data</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="config-ssi-fragment.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> </td></tr></table><hr /></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="backup"></a>Chapter 10. Backing up Docserv² data</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="backup.html#maintain-backup-config">Maintaining, backing up, and restoring configuration files</a></span></dt><dt><span class="section"><a href="backup.html#backup-metadata">Backing up the metadata store</a></span></dt><dt><span class="section"><a href="backup.html#backup-content">Backing up Docserv² content</a></span></dt></dl></div><p>Docserv² itself has no built-in backup functionality.
Neither for the configuration nor for its configuration or its document metadata store.</p><p>You need make sure to back up all relevant data yourself.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="maintain-backup-config"></a>Maintaining, backing up, and restoring configuration files</h2></div></div></div><p>To maintain and back up configuration, create a Git repository at <code class="literal">/etc/docserv/</code>.
To do so, run <code class="literal">git -C /etc/docserv/ init</code>.
Then add, commit, and push all content as desired.</p><p>To restore configuration, use Git commands.
You do not need to exit or restart Docserv² to apply most configuration, as it is re-evaluated upon every build instruction.
The exception to this is restoring site configuration: In this case, make sure to exit Docserv² and restart after having restored it.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="backup-metadata"></a>Backing up the metadata store</h2></div></div></div><p>The metadata store contains metadata extracted from documents, such as document titles and subtitles.
If it is deleted, all metadata will have to be created anew.
This means, all docsets of the site have to be rebuilt which can take a substantial amount of time.
If you do not do so, navigational pages will lose links to most content after the immediate next build.</p><p>To maintain and back up the metadata store, create a Git repository at <code class="literal">/var/cache/docserv/</code>.
To do so, run <code class="literal">git -C /var/cache/docserv/ init</code>.
Create a <code class="literal">.gitignore</code> file that ignores <code class="literal">.json</code> files on the top level of the repository to avoid backing up build queue files.
Then add, commit, and push all content as desired.</p><p>It usually makes sense to create a cronjob that automatically adds/commits/pushes all changes on a regular basis.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="backup-content"></a>Backing up Docserv² content</h2></div></div></div><p>Docserv² content is stored in the directory configured as the <code class="literal">backup_dir</code> in the site configuration for each target.
This directory can be compressed (for example with: <code class="literal">tar -cvf "<span class="emphasis"><em>BACKUP_FILE</em></span>.tar" -C "<span class="emphasis"><em>BACKUP_DIR_FOR_TARGET</em></span>" .</code>).
Finally, upload or copy the backup.</p><p>To restore content, exit Docserv², temporarily rename the <code class="literal">backup_dir</code>.
Then extract the content of the backup to <code class="literal">backup_dir</code>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="config-ssi-fragment.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> </td></tr><tr><td width="40%" align="left" valign="top">Chapter 9. SSI fragments </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>